<template>
    <svg id="Layer_1" viewBox="0 0 512 512"
         xmlns="http://www.w3.org/2000/svg">
        <g>
            <path
                d="m436.985 110.324c-48.377-48.373-112.652-75.013-180.985-75.013s-132.608 26.64-180.985 75.014c-5.859 5.859-5.852 15.36 0 21.213l45.434 45.437c5.859 5.859 15.362 5.853 21.215-.001 30.556-30.564 71.162-47.397 114.336-47.397s83.78 16.833 114.337 47.396c2.813 2.813 6.629 4.395 10.607 4.395 6.482 0 10.295-4.081 10.607-4.394l45.434-45.437c5.859-5.858 5.853-15.36 0-21.213z"
                fill="#ffe600"/>
            <path
                d="m436.985 110.324c-48.377-48.373-112.652-75.013-180.985-75.013v94.267c43.174 0 83.78 16.833 114.337 47.396 2.813 2.813 6.629 4.395 10.607 4.395 6.482 0 10.295-4.081 10.607-4.394l45.434-45.437c5.859-5.859 5.853-15.361 0-21.214z"
                fill="#ffaa32"/>
            <path
                d="m141.662 405.646c-12.906-12.905-47.17-51.068-47.395-114.367.008-43.157 16.839-83.75 47.395-114.303l-66.647-66.651c-48.374 48.37-75.015 112.646-75.015 180.986s26.641 132.616 75.015 180.986c2.929 2.929 6.767 4.393 10.606 4.393s7.678-1.465 10.607-4.394l45.434-45.437c5.858-5.858 5.858-15.355 0-21.213z"
                fill="#9bff00"/>
            <path
                d="m370.338 405.646c12.906-12.905 47.17-51.068 47.395-114.367-.008-43.157-16.839-83.75-47.395-114.303l66.647-66.651c48.374 48.37 75.015 112.646 75.015 180.986s-26.641 132.616-75.015 180.986c-2.929 2.929-6.767 4.393-10.606 4.393s-7.678-1.465-10.607-4.394l-45.434-45.437c-5.858-5.858-5.858-15.355 0-21.213z"
                fill="#ff1e5a"/>
            <path
                d="m94.267 291.279c.008-43.157 16.839-83.75 47.395-114.303l-66.647-66.651c-48.374 48.37-75.015 112.646-75.015 180.986z"
                fill="#00d200"/>
            <path
                d="m370.338 405.646c12.906-12.905 47.17-51.068 47.395-114.367l94.267.032c0 68.34-26.641 132.616-75.015 180.986-2.929 2.929-6.767 4.393-10.606 4.393s-7.678-1.465-10.607-4.394l-45.434-45.437c-5.858-5.858-5.858-15.355 0-21.213z"
                fill="#c40050"/>
            <path style="transform:rotate(20deg);transform-origin: 50% 55%;"
                  :style="{transform:rotate}"
                  d="m222.673 257.977c-18.377 18.377-18.377 48.279 0 66.657 23.216 23.216 137.311 96.066 150.245 104.296 5.931 3.775 13.688 2.923 18.66-2.048 4.971-4.971 5.823-12.728 2.048-18.66-8.23-12.933-81.08-127.029-104.296-150.245-18.377-18.377-48.279-18.377-66.657 0z"
                  fill="#003c50"/>
            <text x="130" y="500" style="font-size:100px">{{ data_points.slice(-1)[0] }}</text>
        </g>
    </svg>

</template>

<script>
export default {
    name: "SpeedMeter",
    props: {
        store: Array
    },
    computed: {
        rotate() {
            const scale = (num, in_min, in_max, out_min, out_max) => {
                return (num - in_min) * (out_max - out_min) / (in_max - in_min) + out_min;
            };
            let data_points = this.data_points;
            const point = data_points.slice(-1)[0];
            const max_point = Math.max(...data_points);
            const min_point = Math.min(...data_points);
            const rotation = scale(point, min_point, max_point, 0, 180);
            return `rotate(${rotation + 90}deg)`;

        },
        data_points() {
            return this.store.map(x => x.payload).map(x => parseInt(x) || 1);
        }
    }
}
</script>

<style scoped>

</style>
